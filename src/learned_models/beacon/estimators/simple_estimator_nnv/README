Same architecture as simple_estimator_gpt, but incorporates nnv loss